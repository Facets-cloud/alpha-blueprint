# Kubernetes Node Pool

## Schema Properties

|                                                             | Type                                          | Description                                                                                                                                                                                      | Required   |
|:------------------------------------------------------------|:----------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------|
| kind                                                        | enum: kubernetes_node_pool                    |                                                                                                                                                                                                  | Yes        |
| flavor                                                      | enum: eks_self_managed, aks, eks_managed      |                                                                                                                                                                                                  | Yes        |
| version                                                     | enum: 0.1, latest                             |                                                                                                                                                                                                  | Yes        |
| lifecycle                                                   | enum: ENVIRONMENT, ENVIRONMENT_BOOTSTRAP      | This field describes the phase in which the resource has to be invoked (`ENVIRONMENT` or `ENVIRONMENT_BOOTSTRAP`)                                                                                | No         |
| disabled                                                    | boolean                                       | Flag to disable the resource                                                                                                                                                                     | No         |
| conditional_on_intent                                       | string                                        | Flag to enable the resource based on intent availability. eg mysql if mysql dashboard is required to be deployed. Note: Need to have the instance running beforehand to avail.                   | No         |
| provided                                                    | boolean                                       | Flag to tell if the resource should not be provisioned by facets                                                                                                                                 | No         |
| depends_on                                                  | array                                         | Dependencies on other resources. e.g. application x may depend on mysql                                                                                                                          | No         |
| metadata.name                                               | string                                        | Name of the resource                                                                                                                                                                             | No         |
|                                                             |                                               |     - if not specified, fallback is the `filename`                                                                                                                                               |            |
| spec                                                        | object                                        | Specification as per resource types schema                                                                                                                                                       | Yes        |
| advanced                                                    | object                                        | Additional fields if any for a particular implementation of a resource                                                                                                                           | No         |
| spec.instance_type                                          | string                                        | Instance type associated with the Node Pool                                                                                                                                                      | No         |
| spec.min_node_count                                         | number                                        | Minimum number of worker nodes                                                                                                                                                                   | No         |
| spec.max_node_count                                         | number                                        | Maximum number of worker nodes                                                                                                                                                                   | No         |
| spec.disk_size                                              | number                                        | Disk size in GiB for worker nodes                                                                                                                                                                | No         |
| spec.azs                                                    | string                                        | Comma separated string of one or more availability zones for the Node Pool                                                                                                                       | No         |
| spec.is_public                                              | boolean                                       | Whether to launch nodes in Public or Private network                                                                                                                                             | No         |
| spec.taints.TAINT_NAME.key                                  | string                                        | The key of the taint                                                                                                                                                                             | No         |
| spec.taints.TAINT_NAME.value                                | string                                        | The value of the taint                                                                                                                                                                           | No         |
| spec.taints.TAINT_NAME.effect                               | enum: NoSchedule, NoExecute, PreferNoSchedule | The effect of the taint                                                                                                                                                                          | No         |
| spec.labels                                                 | object                                        | Key-value map of Kubernetes labels                                                                                                                                                               | No         |
| advanced.aks.node_pool.values.upgrade_settings.max_surge    | string                                        |                                                                                                                                                                                                  | No         |
| advanced.aks.node_pool.values.kubelet_config                | object                                        | Block for all Linux configuration                                                                                                                                                                | No         |
| advanced.aks.node_pool.values.linux_os_config.sysctl_config | object                                        | Block for all System control configurations which should be under linux_os_config                                                                                                                | No         |
| advanced.aks.node_pool.values.tags.test                     | string                                        |                                                                                                                                                                                                  | No         |
| advanced.eks.managed_node_group                             | object                                        | Advanced values as per Terraform AWS EKS Managed Node Group resource https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_node_group                                  | No         |
|                                                             |                                               | Note: If you want to pass multiple intsnace types then you can use `instance_types` attribute in advanced along with spec.instance_type                                                          |            |
| advanced.eks.self_managed_node_group                        | object                                        | Advanced values as per Terraform AWS EKS Self Managed Node Group module https://registry.terraform.io/modules/terraform-aws-modules/eks/aws/latest/submodules/self-managed-node-group?tab=inputs | No         |

## Outputs

|                                   | Type                                          | Description                                                                | Required   | Referencing                                                             |
|:----------------------------------|:----------------------------------------------|:---------------------------------------------------------------------------|:-----------|:------------------------------------------------------------------------|
| out                               | object                                        | Output given by the resource for others to refer.                          | No         | ${kubernetes_node_pool.RESOURCE_NAME.out}                               |
| out.spec.instance_type            | string                                        | Instance type associated with the Node Pool                                | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.instance_type}            |
| out.spec.min_node_count           | number                                        | Minimum number of worker nodes                                             | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.min_node_count}           |
| out.spec.max_node_count           | number                                        | Maximum number of worker nodes                                             | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.max_node_count}           |
| out.spec.disk_size                | number                                        | Disk size in GiB for worker nodes                                          | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.disk_size}                |
| out.spec.azs                      | string                                        | Comma separated string of one or more availability zones for the Node Pool | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.azs}                      |
| out.spec.is_public                | boolean                                       | Whether to launch nodes in Public or Private network                       | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.is_public}                |
| out.spec.taints.TAINT_NAME.key    | string                                        | The key of the taint                                                       | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.taints.TAINT_NAME.key}    |
| out.spec.taints.TAINT_NAME.value  | string                                        | The value of the taint                                                     | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.taints.TAINT_NAME.value}  |
| out.spec.taints.TAINT_NAME.effect | enum: NoSchedule, NoExecute, PreferNoSchedule | The effect of the taint                                                    | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.taints.TAINT_NAME.effect} |
| out.spec.labels                   | object                                        | Key-value map of Kubernetes labels                                         | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.spec.labels}                   |
| out.name                          | string                                        |                                                                            | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.name}                          |
| out.labels                        | object                                        |                                                                            | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.labels}                        |
| out.taints                        | list                                          |                                                                            | No         | ${kubernetes_node_pool.RESOURCE_NAME.out.taints}                        |

