# Log Collector

## Schema Properties

|                                                   | Type                                     | Description                                                                                                                                                                                                                              | Required   |
|:--------------------------------------------------|:-----------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------|
| kind                                              | enum: log_collector                      |                                                                                                                                                                                                                                          | Yes        |
| flavor                                            | enum: loki, loki_s3, loki_blob           |                                                                                                                                                                                                                                          | Yes        |
| version                                           | enum: 0.1, latest                        |                                                                                                                                                                                                                                          | Yes        |
| lifecycle                                         | enum: ENVIRONMENT, ENVIRONMENT_BOOTSTRAP | This field describes the phase in which the resource has to be invoked (`ENVIRONMENT` or `ENVIRONMENT_BOOTSTRAP`)                                                                                                                        | No         |
| disabled                                          | boolean                                  | Flag to disable the resource                                                                                                                                                                                                             | No         |
| conditional_on_intent                             | string                                   | Flag to enable the resource based on intent availability. eg mysql if mysql dashboard is required to be deployed. Note: Need to have the instance running beforehand to avail.                                                           | No         |
| provided                                          | boolean                                  | Flag to tell if the resource should not be provisioned by facets                                                                                                                                                                         | No         |
| depends_on                                        | array                                    | Dependencies on other resources. e.g. application x may depend on mysql                                                                                                                                                                  | No         |
| metadata.name                                     | string                                   | Name of the resource                                                                                                                                                                                                                     | No         |
|                                                   |                                          |     - if not specified, fallback is the `filename`                                                                                                                                                                                       |            |
| spec                                              | object                                   | Specification as per resource types schema                                                                                                                                                                                               | Yes        |
| advanced                                          | object                                   | Additional fields if any for a particular implementation of a resource                                                                                                                                                                   | No         |
| spec.retentation_days                             | number                                   | The number of days to retain an object after being created. Specify the number of days as an integer, e.g. 30 for 30 days                                                                                                                | No         |
| spec.storage_size                                 | string                                   | Storage capacity to store logs. You can express storage size as a plain integer or as a fixed-point number using one of these quantity suffixes: E, P, T, G, M, k. You can also use the power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki | No         |
| advanced.loki.loki.values                         | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/grafana/loki-distributed                                                                                                                                               | No         |
|                                                   |                                          |  Note: By default `loki.structuredConfig.storage_config` is configured to use minio storage backend                                                                                                                                      |            |
| advanced.loki.minio.values                        | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/bitnami/minio                                                                                                                                                          | No         |
| advanced.loki.promtail.values                     | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/grafana/promtail                                                                                                                                                       | No         |
|                                                   |                                          |  Note: By default, loki push endpoint will be configured automatically to send log entries to Loki                                                                                                                                       |            |
| advanced.loki.loki_canary.enable_loki_canary      | boolean                                  | Whether to enable loki canary or not                                                                                                                                                                                                     | No         |
| advanced.loki.loki_canary.values                  | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/grafana/loki-canary                                                                                                                                                    | No         |
|                                                   |                                          |  Note: By default, `lokiAddress` will be set with loki endpoint and `serviceMonitor` is enabled                                                                                                                                          |            |
| advanced.loki_s3.bucket_name                      | string                                   | AWS S3 bucket name to distribute chunks.                                                                                                                                                                                                 | No         |
|                                                   |                                          |  Note: You can use AWS S3 module (https://facets-cloud.github.io/facets-schemas/schemas/s3/s3.schema.json) to create bucket and map the name using `${s3.<name-of-your-resource>.bucket_name}`                                           |            |
| advanced.loki_s3.loki.values                      | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/grafana/loki-distributed                                                                                                                                               | No         |
|                                                   |                                          |  Note: By default `loki.structuredConfig.storage_config` is configured to use minio storage backend                                                                                                                                      |            |
| advanced.loki_s3.minio.values                     | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/bitnami/minio                                                                                                                                                          | No         |
| advanced.loki_s3.promtail.values                  | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/grafana/promtail                                                                                                                                                       | No         |
|                                                   |                                          |  Note: By default, loki push endpoint will be configured automatically to send log entries to Loki                                                                                                                                       |            |
| advanced.loki_s3.loki_canary.enable_loki_canary   | boolean                                  | Whether to enable loki canary or not                                                                                                                                                                                                     | No         |
| advanced.loki_s3.loki_canary.values               | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/grafana/loki-canary                                                                                                                                                    | No         |
|                                                   |                                          |  Note: By default, `lokiAddress` will be set with loki endpoint and `serviceMonitor` is enabled                                                                                                                                          |            |
| advanced.loki_blob.container_name                 | string                                   | the container name which you created via azure_storage_container `${azure_storage_container.<name-of-your-resource>.out.attributes.container_name}`                                                                                      | No         |
| advanced.loki_blob.storage_account_name           | string                                   | the storage account name which is part of the container that is  created via azure_storage_container `${azure_storage_container.<name-of-your-resource>.out.attributes.storage_account_name}`                                            | No         |
| advanced.loki_blob.primary_access_key             | string                                   | the storage account primary access key that is created for the storage account  `${azure_storage_container.<name-of-your-resource>.out.attributes.primary_access_key}`                                                                   | No         |
| advanced.loki_blob.loki.values                    | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/grafana/loki-distributed                                                                                                                                               | No         |
|                                                   |                                          |  Note: By default `loki.structuredConfig.storage_config` is configured to use minio storage backend                                                                                                                                      |            |
| advanced.loki_blob.minio.values                   | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/bitnami/minio                                                                                                                                                          | No         |
| advanced.loki_blob.promtail.values                | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/grafana/promtail                                                                                                                                                       | No         |
|                                                   |                                          |  Note: By default, loki push endpoint will be configured automatically to send log entries to Loki                                                                                                                                       |            |
| advanced.loki_blob.loki_canary.enable_loki_canary | boolean                                  | Whether to enable loki canary or not                                                                                                                                                                                                     | No         |
| advanced.loki_blob.loki_canary.values             | object                                   | Helm values as per the chart https://artifacthub.io/packages/helm/grafana/loki-canary                                                                                                                                                    | No         |
|                                                   |                                          |  Note: By default, `lokiAddress` will be set with loki endpoint and `serviceMonitor` is enabled                                                                                                                                          |            |

## Outputs

|                           | Type   | Description                                                                                                                                                                                                                              | Required   | Referencing                                              |
|:--------------------------|:-------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------|:---------------------------------------------------------|
| out                       | object | Output given by the resource for others to refer.                                                                                                                                                                                        | No         | ${log_collector.RESOURCE_NAME.out}                       |
| out.spec.retentation_days | number | The number of days to retain an object after being created. Specify the number of days as an integer, e.g. 30 for 30 days                                                                                                                | No         | ${log_collector.RESOURCE_NAME.out.spec.retentation_days} |
| out.spec.storage_size     | string | Storage capacity to store logs. You can express storage size as a plain integer or as a fixed-point number using one of these quantity suffixes: E, P, T, G, M, k. You can also use the power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki | No         | ${log_collector.RESOURCE_NAME.out.spec.storage_size}     |

