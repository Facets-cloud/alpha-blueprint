# Service

## Schema Properties

|                                                                                  | Type                                         | Description                                                                                                                                                                                                                                                                                        | Required   |
|:---------------------------------------------------------------------------------|:---------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------|
| kind                                                                             | enum: service                                | Describes the type of resource. e.g. ingress, application, mysql etc. If not specified, fallback is the `folder_name`/instances                                                                                                                                                                    | No         |
| flavor                                                                           | enum: default                                | Implementation selector for the resource. e.g. for a resource type ingress, default, aws_alb, gcp_alb etc.                                                                                                                                                                                         | No         |
| version                                                                          | enum: 0.1                                    | This field can be used to pin to a particular version                                                                                                                                                                                                                                              | No         |
| lifecycle                                                                        | enum: ENVIRONMENT, ENVIRONMENT_BOOTSTRAP     | This field describes the phase in which the resource has to be invoked (`ENVIRONMENT` or `ENVIRONMENT_BOOTSTRAP`)                                                                                                                                                                                  | No         |
| disabled                                                                         | boolean                                      | Flag to disable the resource                                                                                                                                                                                                                                                                       | No         |
| conditional_on_intent                                                            | string                                       | Flag to enable the resource based on intent availability. eg mysql if mysql dashboard is required to be deployed. Note: Need to have the instance running beforehand to avail.                                                                                                                     | No         |
| provided                                                                         | boolean                                      | Flag to tell if the resource should not be provisioned by facets                                                                                                                                                                                                                                   | No         |
| depends_on                                                                       | array                                        | Dependencies on other resources. e.g. application x may depend on mysql                                                                                                                                                                                                                            | No         |
| metadata.name                                                                    | string                                       | Name of the resource                                                                                                                                                                                                                                                                               | No         |
|                                                                                  |                                              |     - if not specified, fallback is the `filename`                                                                                                                                                                                                                                                 |            |
| spec                                                                             | object                                       | Specification as per resource types schema                                                                                                                                                                                                                                                         | No         |
| advanced                                                                         | object                                       | Additional fields if any for a particular implementation of a resource                                                                                                                                                                                                                             | No         |
| spec.release.image                                                               | string                                       | The docker image of the application that you want to run                                                                                                                                                                                                                                           | No         |
| spec.release.build.artifactory                                                   | string                                       | Parent artifactory name                                                                                                                                                                                                                                                                            | No         |
| spec.release.build.name                                                          | string                                       | Name of the artifactory                                                                                                                                                                                                                                                                            | No         |
| spec.release.strategy.type                                                       | enum: RollingUpdate, Recreate                | Your kubernetes rollout type eg: RollingUpdate or Recreate                                                                                                                                                                                                                                         | No         |
| spec.release.strategy.max_available                                              | integer                                      | If type RollingUpdate , this is the max number of pods that can be created from the default replicas                                                                                                                                                                                               | No         |
| spec.release.strategy.max_unavailable                                            | integer                                      | If type RollingUpdate , this is the max number of pods that can be unavailable from the default replicas                                                                                                                                                                                           | No         |
| spec.release.disruption_policy.min_available                                     | integer                                      | This is the min number of pods should be available in case of failures                                                                                                                                                                                                                             | No         |
| spec.release.disruption_policy.max_unavailable                                   | integer                                      | This is the max number of pods that can be unavailable during a failure.                                                                                                                                                                                                                           | No         |
| spec.type                                                                        | enum: application, statefulset, cronjob, job | This will specify the type of service you want to create. eg: application, statefulset,cronjob etc                                                                                                                                                                                                 | No         |
| spec.enable_host_anti_affinity                                                   | boolean                                      | boolean to enable or disable host anti affinity                                                                                                                                                                                                                                                    | No         |
| spec.env                                                                         | object                                       | The key value pairs of all the environment variables that needs to be passed to the pod                                                                                                                                                                                                            | No         |
| spec.runtime.command                                                             | array                                        | The list of commands you want to perform before starting the container                                                                                                                                                                                                                             | No         |
| spec.runtime.args                                                                | array                                        | The list of arguments you want to pass for the above mentioned command                                                                                                                                                                                                                             | No         |
| spec.runtime.ports.PORT_NAME.PORT_NAME_NAME.protocol                             | enum: tcp, udp                               | the protocol of the port , either tcp or udp                                                                                                                                                                                                                                                       | No         |
| spec.runtime.ports.PORT_NAME.PORT_NAME_NAME.port                                 | string                                       | the port number where the pod is exposed                                                                                                                                                                                                                                                           | No         |
| spec.runtime.ports.PORT_NAME.PORT_NAME_NAME.service_port                         | string                                       | the port number where the service is exposed, this is optional                                                                                                                                                                                                                                     | No         |
| spec.runtime.metrics.METRIC_NAME.METRIC_NAME_NAME.path                           | string                                       | the path where the service monitor should scrape metrics                                                                                                                                                                                                                                           | No         |
| spec.runtime.metrics.METRIC_NAME.METRIC_NAME_NAME.port_name                      | string                                       | name of the service monitor                                                                                                                                                                                                                                                                        | No         |
| spec.runtime.size.cpu                                                            | string                                       | The number of CPU cores required, e.g '1' or '1000m'                                                                                                                                                                                                                                               | No         |
| spec.runtime.size.memory                                                         | string                                       | The amount of memory required, e.g '800Mi' or '1.5Gi'                                                                                                                                                                                                                                              | No         |
| spec.runtime.volumes.config_maps.CONFIG_MAP_NAME.CONFIG_MAP_NAME_NAME.name       | string                                       | The name of the config map that has been created in the kubernetes cluster                                                                                                                                                                                                                         | No         |
| spec.runtime.volumes.config_maps.CONFIG_MAP_NAME.CONFIG_MAP_NAME_NAME.mount_path | string                                       | The mount path for the config map                                                                                                                                                                                                                                                                  | No         |
| spec.runtime.health_checks.start_up_time                                         | integer                                      | The time kubernetes api needs to wait until the application is ready                                                                                                                                                                                                                               | No         |
| spec.runtime.health_checks.timeout                                               | integer                                      | Timeout for the health check                                                                                                                                                                                                                                                                       | No         |
| spec.runtime.health_checks.period                                                | integer                                      | This is the repeated interval in which kubelet does a health check                                                                                                                                                                                                                                 | No         |
| spec.runtime.health_checks.port                                                  | integer                                      | Specify the port in which the health checks should be made                                                                                                                                                                                                                                         | No         |
| spec.runtime.health_checks.liveness_url                                          | string                                       | URL to make the liveness check                                                                                                                                                                                                                                                                     | No         |
| spec.runtime.health_checks.readiness_url                                         | string                                       | URL to make the readiness check                                                                                                                                                                                                                                                                    | No         |
| spec.runtime.health_checks.liveness_exec_command                                 | array                                        | The list of commands to make liveness check                                                                                                                                                                                                                                                        | No         |
| spec.runtime.health_checks.readiness_exec_command                                | array                                        | The list of commands to make readiness check                                                                                                                                                                                                                                                       | No         |
| spec.runtime.autoscaling.min                                                     | integer                                      | This is the min replicas where the hpa downscales to                                                                                                                                                                                                                                               | No         |
| spec.runtime.autoscaling.max                                                     | integer                                      | This is the max replicas where the hpa upscales to                                                                                                                                                                                                                                                 | No         |
| spec.runtime.autoscaling.cpu_threshold                                           | integer                                      | The max cpu threshold that the hpa waits until it upscales                                                                                                                                                                                                                                         | No         |
| spec.runtime.autoscaling.ram_threshold                                           | integer                                      | The max ram threshold that the hpa waits until it upscales                                                                                                                                                                                                                                         | No         |
| spec.runtime.autoscaling.packets_per_second                                      | string                                       | The max number of packets that can be sent to the pod, once exceeded it autoscales. eg: 10k                                                                                                                                                                                                        | No         |
| spec.runtime.autoscaling.requests_per_second.threshold                           | string                                       | The rps threshold that hpa looks for , once exceeds it autoscales eg: 10k                                                                                                                                                                                                                          | No         |
| spec.runtime.autoscaling.requests_per_second.ingress_name                        | string                                       | Name of the ingress object that the hpa should watch for autoscaling                                                                                                                                                                                                                               | No         |
| spec.restart_policy                                                              | enum: Always, OnFailure, Never               | Can be of type Always , OnFailure or Never                                                                                                                                                                                                                                                         | No         |
| advanced.aws.iam.IAM_NAME.IAM_NAME_NAME.arn                                      | string                                       | The arn of the policy that you want to create a role and attach it to the deployment                                                                                                                                                                                                               | No         |
| advanced.gcp.iam.IAM_NAME.IAM_NAME_NAME.role                                     | string                                       | The id of the role that you want to attach to the deployment, you can check out this link on how to create roles in gcp https://cloud.google.com/iam/docs/creating-custom-roles#iam-custom-roles-get-metadata-console                                                                              | No         |
| advanced.chart.image_pull_secrets                                                | object                                       | Map of all the image pull secrets for the container image to be pulled from the repository. Each map should have name specified within it. For more information refer to: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/#create-a-pod-that-uses-your-secret | No         |
| advanced.chart.node_selector                                                     | object                                       | Map of all node selectors for the application                                                                                                                                                                                                                                                      | No         |

## Outputs

|                                                                     | Type    | Description                                                                             | Required   | Referencing                                                                                  |
|:--------------------------------------------------------------------|:--------|:----------------------------------------------------------------------------------------|:-----------|:---------------------------------------------------------------------------------------------|
| out                                                                 | object  | Output given by the resource for others to refer.                                       | No         | ${service.RESOURCE_NAME.out}                                                                 |
| out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.host              | string  | The hostname or IP address of the database or cache server.                             | No         | ${service.RESOURCE_NAME.out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.host}              |
| out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.port              | integer | The port number to use for connecting to the database or cache server.                  | No         | ${service.RESOURCE_NAME.out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.port}              |
| out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.username          | string  | The username to use for authentication when connecting to the database or cache server. | No         | ${service.RESOURCE_NAME.out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.username}          |
| out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.password          | string  | The password to use for authentication when connecting to the database or cache server. | No         | ${service.RESOURCE_NAME.out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.password}          |
| out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.connection_string | string  | The connection_string to use when connecting to the datastore.                          | No         | ${service.RESOURCE_NAME.out.interfaces.INTERFACE_NAME.INTERFACE_NAME_NAME.connection_string} |

