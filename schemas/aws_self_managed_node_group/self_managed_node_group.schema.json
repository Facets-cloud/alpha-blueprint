{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "type": "object",
  "allOf": [
    {
      "$ref": "../../traits/base.schema.json"
    },
    {
      "$ref": "#/$defs/specDef"
    },
    {
      "$ref": "#/$defs/advancedDef"
    },
    {
      "$ref": "#/$defs/outDef"
    }
  ],
  "required": [
    "kind",
    "flavor",
    "version",
    "metadata",
    "spec"
  ],
  "$defs": {
    "specDef": {
      "type": "object",
      "properties": {
        "spec": {
          "type": "object",
          "properties": {
            "instance_type": {
              "type": "string",
              "description": "The type of the instance to launch"
            },
            "is_public": {
              "type": "boolean",
              "description": "Whether to launch nodes in Public or Private network"
            },
            "min_node_count": {
              "type": "number",
              "description": "Minimum number of worker nodes"
            },
            "max_node_count": {
              "type": "number",
              "description": "Maximum number of worker nodes"
            },
            "taints": {
              "type": "object",
              "description": "The Kubernetes taints to be applied to the nodes in the node group. Maximum of 50 taints per node group",
              "patternProperties": {
                "^[a-zA-Z]+\\d+$": {
                  "type": "object",
                  "description": "Specify taint",
                  "properties": {
                    "key": {
                      "type": "string",
                      "description": "The key of the taint",
                      "minLength": 2,
                      "maxLength": 63
                    },
                    "value": {
                      "type": "string",
                      "description": "The value of the taint",
                      "minLength": 2,
                      "maxLength": 63
                    },
                    "effect": {
                      "type": "string",
                      "description": "The effect of the taint",
                      "enum": [
                        "NoSchedule",
                        "NoExecute",
                        "PreferNoSchedule"
                      ]
                    }
                  }
                }
              }
            },
            "labels": {
              "type": "object",
              "description": "Key-value map of Kubernetes labels. Only labels that are applied with the EKS API are managed by this argument. Other Kubernetes labels applied to the EKS Node Group will not be managed",
              "required": []
            }
          }
        },
        "required": [
          "instance_types",
          "min_node_count",
          "max_node_count",
          "disk_size",
          "capacity_type",
          "taints",
          "labels"
        ]
      }
    },
    "advancedDef": {
      "type": "object",
      "properties": {
        "advanced": {
          "anyOf": [
            {
              "$ref": "./flavor-eks-self-managed.schema.json"
            }
          ]
        }
      }
    },
    "outDef": {
      "type": "object",
      "properties": {
        "out": {
          "type": "object",
          "additionalProperties": false,
          "allOf": [
            {
              "$ref": "#/$defs/specDef"
            },
            {
              "properties": {
                "name": {
                  "type": "string",
                  "additionalProperties": false
                },
                "labels": {
                  "type": "object",
                  "additionalProperties": false
                },
                "taints": {
                  "type": "list",
                  "additionalProperties": false
                }
              },
              "required": [
              ]
            }
          ]
        }
      }
    }
  }
}
